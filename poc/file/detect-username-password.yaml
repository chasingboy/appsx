id: file-analyse

info:
  name: File Analyse
  author: xboy
  severity: info
  description: |
    This process involves extracting username and password
  metadata:
    verified: true
  tags: file,analyse,js,javascript
file:
  - extensions:
      - all

    extractors:
      - type: regex
        name: username-found
        regex:
          - "user = \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user = '([^;\"\\'\\s\\{\\(]+?)'"
          - "user=\"([^;\"\\'\\s\\{\\(]+?)\""
          - "user='([^;\"\\'\\s\\{\\(]+?)'"
          - "user=='([^;\"\\'\\s\\{\\(]+?)'"
          - "user == '([^;\"\\'\\s\\{\\(]+?)'"
          
          - "user : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user:\"([^;\"\\'\\s\\{\\(]+?)\""
          - "user: \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user : '([^;\"\\'\\s\\{\\(]+?)'"
          - "user:'([^;\"\\'\\s\\{\\(]+?)'"
          - "user: '([^;\"\\'\\s\\{\\(]+?)'"

          - "user\" : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user\":\"([^;\"\\'\\s\\{\\(]+?)\""
          - "user\": \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user\" : '([^;\"\\'\\s\\{\\(]+?)'"
          - "user\":'([^;\"\\'\\s\\{\\(]+?)'"
          - "user\": '([^;\"\\'\\s\\{\\(]+?)'"

          - "user' : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user':\"([^;\"\\'\\s\\{\\(]+?)\""
          - "user': \"([^;\"\\'\\s\\{\\(]+?)\""
          - "user' : '([^;\"\\'\\s\\{\\(]+?)'"
          - "user':'([^;\"\\'\\s\\{\\(]+?)'"
          - "user': '([^;\"\\'\\s\\{\\(]+?)'"

      - type: regex
        name: username-found
        regex:
          - "username = \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username = '([^;\"\\'\\s\\{\\(]+?)'"
          - "username=\"([^;\"\\'\\s\\{\\(]+?)\""
          - "username='([^;\"\\'\\s\\{\\(]+?)'"
          - "username=='([^;\"\\'\\s\\{\\(]+?)'"
          - "username == '([^;\"\\'\\s\\{\\(]+?)'"
          
          - "username : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username:\"([^;\"\\'\\s\\{\\(]+?)\""
          - "username: \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username : '([^;\"\\'\\s\\{\\(]+?)'"
          - "username:'([^;\"\\'\\s\\{\\(]+?)'"
          - "username: '([^;\"\\'\\s\\{\\(]+?)'"

          - "username\" : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username\":\"([^;\"\\'\\s\\{\\(]+?)\""
          - "username\": \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username\" : '([^;\"\\'\\s\\{\\(]+?)'"
          - "username\":'([^;\"\\'\\s\\{\\(]+?)'"
          - "username\": '([^;\"\\'\\s\\{\\(]+?)'"

          - "username' : \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username':\"([^;\"\\'\\s\\{\\(]+?)\""
          - "username': \"([^;\"\\'\\s\\{\\(]+?)\""
          - "username' : '([^;\"\\'\\s\\{\\(]+?)'"
          - "username':'([^;\"\\'\\s\\{\\(]+?)'"
          - "username': '([^;\"\\'\\s\\{\\(]+?)'"

      - type: regex
        name: password-found
        regex:
          - "pass = \"([^;\"\\'\\s\\{]+?)\""
          - "pass = '([^;\"\\'\\s\\{]+?)'"
          - "pass=\"([^;\"\\'\\s\\{]+?)\""
          - "pass='([^;\"\\'\\s\\{]+?)'"
          - "pass=='([^;\"\\'\\s\\{]+?)'"
          - "pass == '([^;\"\\'\\s\\{]+?)'"
          
          - "pass : \"([^;\"\\'\\s\\{]+?)\""
          - "pass:\"([^;\"\\'\\s\\{]+?)\""
          - "pass: \"([^;\"\\'\\s\\{]+?)\""
          - "pass : '([^;\"\\'\\s\\{]+?)'"
          - "pass:'([^;\"\\'\\s\\{]+?)'"
          - "pass: '([^;\"\\'\\s\\{]+?)'"

          - "pass\" : \"([^;\"\\'\\s\\{]+?)\""
          - "pass\":\"([^;\"\\'\\s\\{]+?)\""
          - "pass\": \"([^;\"\\'\\s\\{]+?)\""
          - "pass\" : '([^;\"\\'\\s\\{]+?)'"
          - "pass\":'([^;\"\\'\\s\\{]+?)'"
          - "pass\": '([^;\"\\'\\s\\{]+?)'"

          - "pass' : \"([^;\"\\'\\s\\{]+?)\""
          - "pass':\"([^;\"\\'\\s\\{]+?)\""
          - "pass': \"([^;\"\\'\\s\\{]+?)\""
          - "pass' : '([^;\"\\'\\s\\{]+?)'"
          - "pass':'([^;\"\\'\\s\\{]+?)'"
          - "pass': '([^;\"\\'\\s\\{]+?)'"

      - type: regex
        name: password-found
        regex:
          - "password = \"([^;\"\\'\\s\\{]+?)\""
          - "password = '([^;\"\\'\\s\\{]+?)'"
          - "password=\"([^;\"\\'\\s\\{]+?)\""
          - "password='([^;\"\\'\\s\\{]+?)'"
          - "password=='([^;\"\\'\\s\\{]+?)'"
          - "password == '([^;\"\\'\\s\\{]+?)'"
          
          - "password : \"([^;\"\\'\\s\\{]+?)\""
          - "password:\"([^;\"\\'\\s\\{]+?)\""
          - "password: \"([^;\"\\'\\s\\{]+?)\""
          - "password : '([^;\"\\'\\s\\{]+?)'"
          - "password:'([^;\"\\'\\s\\{]+?)'"
          - "password: '([^;\"\\'\\s\\{]+?)'"

          - "password\" : \"([^;\"\\'\\s\\{]+?)\""
          - "password\":\"([^;\"\\'\\s\\{]+?)\""
          - "password\": \"([^;\"\\'\\s\\{]+?)\""
          - "password\" : '([^;\"\\'\\s\\{]+?)'"
          - "password\":'([^;\"\\'\\s\\{]+?)'"
          - "password\": '([^;\"\\'\\s\\{]+?)'"

          - "password' : \"([^;\"\\'\\s\\{]+?)\""
          - "password':\"([^;\"\\'\\s\\{]+?)\""
          - "password': \"([^;\"\\'\\s\\{]+?)\""
          - "password' : '([^;\"\\'\\s\\{]+?)'"
          - "password':'([^;\"\\'\\s\\{]+?)'"
          - "password': '([^;\"\\'\\s\\{]+?)'"

      - type: regex
        name: password-found
        regex:
          - "pwd = \"([^;\"\\'\\s\\{]+?)\""
          - "pwd = '([^;\"\\'\\s\\{]+?)'"
          - "pwd=\"([^;\"\\'\\s\\{]+?)\""
          - "pwd='([^;\"\\'\\s\\{]+?)'"
          - "pwd=='([^;\"\\'\\s\\{]+?)'"
          - "pwd == '([^;\"\\'\\s\\{]+?)'"
          
          - "pwd : \"([^;\"\\'\\s\\{]+?)\""
          - "pwd:\"([^;\"\\'\\s\\{]+?)\""
          - "pwd: \"([^;\"\\'\\s\\{]+?)\""
          - "pwd : '([^;\"\\'\\s\\{]+?)'"
          - "pwd:'([^;\"\\'\\s\\{]+?)'"
          - "pwd: '([^;\"\\'\\s\\{]+?)'"

          - "pwd\" : \"([^;\"\\'\\s\\{]+?)\""
          - "pwd\":\"([^;\"\\'\\s\\{]+?)\""
          - "pwd\": \"([^;\"\\'\\s\\{]+?)\""
          - "pwd\" : '([^;\"\\'\\s\\{]+?)'"
          - "pwd\":'([^;\"\\'\\s\\{]+?)'"
          - "pwd\": '([^;\"\\'\\s\\{]+?)'"

          - "pwd' : \"([^;\"\\'\\s\\{]+?)\""
          - "pwd':\"([^;\"\\'\\s\\{]+?)\""
          - "pwd': \"([^;\"\\'\\s\\{]+?)\""
          - "pwd' : '([^;\"\\'\\s\\{]+?)'"
          - "pwd':'([^;\"\\'\\s\\{]+?)'"
          - "pwd': '([^;\"\\'\\s\\{]+?)'"

      - type: regex
        name: email-found
        regex:
          - "(?i)(([a-z0-9][_|\\.])*[a-z0-9]+@([a-z0-9][-|_|\\.])*[a-z0-9\\.]*[a-z0-9]+\\.(cn|com|org|net|info|top|shop|vip|xyz|club|xyz))"

